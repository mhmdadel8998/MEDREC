{% load bootstrap4%}

{%block check%}
{% load static %}

<!DOCTYPE html>
<html>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <head>
    <title>Check</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="bootstrap-4.5.3-dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="{% static 'css/check.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="manifest" href="manifest.json" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
      integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"
      integrity="sha256-srhz/t0GOrmVGZryG24MVDyFDYZpvUH2+dnJ8FbpGi0="
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript" src="jspdf.debug.js"></script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>HTML-to-PDF Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="html2pdf.bundle.min.js"></script>
    
  </head>
  {% include 'Pages/header.html'%}
  <body>
      <div class="container">
        <div class="main">
          <div class="row">
            <div class="col-md-4 mt-1">
              <div class="card text-center sidebar">
                <div class="card">
                  <img src="{% static 'css/Images/logoo.png' %}" />
                  <div class="mt-3">
                    <h3>{%for profile in profile%}
                      {{ profile.user.first_name}}
                      {%endfor%}</h3>
                      <a href="{% url 'myrecords' %}">Records</a>
                      <a href="{% url 'prediction' %}">Diet advise</a>
                      <a href="{% url 'chart' %}">Statistics Details</a>
                      <a href="{% url 'check' %}">Prescription Check</a>
                      <a href="{% url 'profile' %}">Back</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-8 mt-1">
              <div class="card mb-3 content">
                <!-- <p>Prescription</p> -->
                <div class="prescription_form" id="invoice">
                  <table
                    class="prescription"
                    data-prescription_id="<?php echo $presc->prescription_id; ?>"
                    border="1"
                  >
                    <tbody>
                      <tr height="15%">
                        <td colspan="2">
                          <div class="head">
                            <div class="logo">
                              <img src="{% static 'css/Images/logoo.png' %}" />
                            </div>
                            <div class="credentials">
                              <h4>{{profile.user.first_name}} {{profile.user.last_name}}</h4>
                            </div>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td width="40%">
                          <div class="desease_details">
                            <div class="tests">
                              <h4 class="d-header">Tests</h4>
                              <form class="form2" action="#">
                                <label for="tests">Test 1</label>
                                <select name="tests" id="tests">
                                  <option > </option>
                                  <option >A1C Test</option>
                                  <option >Fasting Blood Sugar Test</option>
                                  <option >Glucose Tolerance Test</option>
                                  <option >Random Blood Sugar Test</option>
                                  <option >Tests for Gestational Diabetes</option>
                                  <option >Glucose Screening Test</option>
                                  <option >Glucose Tolerance Test</option>
                                  <option >Prevent Type 2 Diabetes</option>
                                  <option >Diabetes Treatment Plan</option>
                                </select>
                                <!-- <input type="submit" value="Submit" /> -->
                          </form>
                          <hr>
                          <form class="form2" action="#">
                            <label for="tests">Test 2</label>
                            <select name="tests" id="tests">
                              <option >Select Test 2</option>
                              <option >A1C Test</option>
                              <option >Fasting Blood Sugar Test</option>
                              <option >Glucose Tolerance Test</option>
                              <option >Random Blood Sugar Test</option>
                              <option >Tests for Gestational Diabetes</option>
                              <option >Glucose Screening Test</option>
                              <option >Glucose Tolerance Test</option>
                              <option >Prevent Type 2 Diabetes</option>
                              <option >Diabetes Treatment Plan</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                      <hr>
                      <form class="form2" action="#">
                        <label for="tests">Test 3</label>
                        <select name="tests" id="tests">
                          <option >Select Test 3</option>
                          <option >A1C Test</option>
                          <option >Fasting Blood Sugar Test</option>
                          <option >Glucose Tolerance Test</option>
                          <option >Random Blood Sugar Test</option>
                          <option >Tests for Gestational Diabetes</option>
                          <option >Glucose Screening Test</option>
                          <option >Glucose Tolerance Test</option>
                          <option >Prevent Type 2 Diabetes</option>
                          <option >Diabetes Treatment Plan</option>
                        </select>
                        <!-- <input type="submit" value="Submit" /> -->
                  </form>
                            </div>
                           
                          </div>
                        </td>
                        <td width="60%" valign="top">
                          <h4 class="d-header">Medicines</h4>
                          <form action="#">
                            <label for="medicines">Drug 1</label>
                            <select name="medicines" id="med">
                              <option >Select drug 1</option>
                              <option >Actos</option>
                              <option >Actrapid</option>
                              <option >Augmentin</option>
                              <option >Amaryl</option>
                              <option >Byetta</option>
                              <option >Bydreoun</option>
                              <option >Competact</option>
                              <option >Diamicron</option>
                              <option >Eucreas</option>
                              <option >Forxiga</option>
                              <option >Galvus</option>
                              <option >Gliclazide	</option>
                              <option >Glucobay</option>
                              <option >Humalog</option>
                              <option >Humulin I</option>
                              <option >Hypurin Bovine Isophane</option>
                              <option >Hypurin Bovine Lente</option>
                              <option >Hypurin Bovine Protamine Zinc</option>
                              <option >Insulin Glulisine</option>
                              <option >Insuman Basal</option>
                              <option >Insuman Comb</option>
                              <option >Janumet</option>
                              <option >Januvia</option>
                              <option >Lantus</option>
                              <option >Lucentis</option>
                              <option >Lyxumia</option>
                              <option >Metformin</option>
                              <option >NovoRapid</option>
                              <option >Prandin</option>
                              <option >Starlix</option>
                              <option >Trulicity</option>
                              <option >Victoza</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                          <hr />
                          <form action="#">
                            <label for="medicines">Drug 2</label>
                            <select name="medicines" id="med">
                              <option >Select drug 2</option>
                              <option >Actos</option>
                              <option >Actrapid</option>
                              <option >Augmentin</option>
                              <option >Amaryl</option>
                              <option >Byetta</option>
                              <option >Bydreoun</option>
                              <option >Competact</option>
                              <option >Diamicron</option>
                              <option >Eucreas</option>
                              <option >Forxiga</option>
                              <option >Galvus</option>
                              <option >Gliclazide	</option>
                              <option >Glucobay</option>
                              <option >Humalog</option>
                              <option >Humulin I</option>
                              <option >Hypurin Bovine Isophane</option>
                              <option >Hypurin Bovine Lente</option>
                              <option >Hypurin Bovine Protamine Zinc</option>
                              <option >Insulin Glulisine</option>
                              <option >Insuman Basal</option>
                              <option >Insuman Comb</option>
                              <option >Janumet</option>
                              <option >Januvia</option>
                              <option >Lantus</option>
                              <option >Lucentis</option>
                              <option >Lyxumia</option>
                              <option >Metformin</option>
                              <option >NovoRapid</option>
                              <option >Prandin</option>
                              <option >Starlix</option>
                              <option >Trulicity</option>
                              <option >Victoza</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                          <hr />
                          <form action="#">
                            <label for="medicines">Drug 3</label>
                            <select name="medicines" id="med">
                              <option >Select drug 3</option>
                              <option >Actos</option>
                              <option >Actrapid</option>
                              <option >Augmentin</option>
                              <option >Amaryl</option>
                              <option >Byetta</option>
                              <option >Bydreoun</option>
                              <option >Competact</option>
                              <option >Diamicron</option>
                              <option >Eucreas</option>
                              <option >Forxiga</option>
                              <option >Galvus</option>
                              <option >Gliclazide	</option>
                              <option >Glucobay</option>
                              <option >Humalog</option>
                              <option >Humulin I</option>
                              <option >Hypurin Bovine Isophane</option>
                              <option >Hypurin Bovine Lente</option>
                              <option >Hypurin Bovine Protamine Zinc</option>
                              <option >Insulin Glulisine</option>
                              <option >Insuman Basal</option>
                              <option >Insuman Comb</option>
                              <option >Janumet</option>
                              <option >Januvia</option>
                              <option >Lantus</option>
                              <option >Lucentis</option>
                              <option >Lyxumia</option>
                              <option >Metformin</option>
                              <option >NovoRapid</option>
                              <option >Prandin</option>
                              <option >Starlix</option>
                              <option >Trulicity</option>
                              <option >Victoza</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                          <hr />
                          <form action="#">
                            <label for="medicines">Drug 4</label>
                            <select name="medicines" id="med">
                              <option >Select drug 4</option>
                              <option >Actos</option>
                              <option >Actrapid</option>
                              <option >Augmentin</option>
                              <option >Amaryl</option>
                              <option >Byetta</option>
                              <option >Bydreoun</option>
                              <option >Competact</option>
                              <option >Diamicron</option>
                              <option >Eucreas</option>
                              <option >Forxiga</option>
                              <option >Galvus</option>
                              <option >Gliclazide	</option>
                              <option >Glucobay</option>
                              <option >Humalog</option>
                              <option >Humulin I</option>
                              <option >Hypurin Bovine Isophane</option>
                              <option >Hypurin Bovine Lente</option>
                              <option >Hypurin Bovine Protamine Zinc</option>
                              <option >Insulin Glulisine</option>
                              <option >Insuman Basal</option>
                              <option >Insuman Comb</option>
                              <option >Janumet</option>
                              <option >Januvia</option>
                              <option >Lantus</option>
                              <option >Lucentis</option>
                              <option >Lyxumia</option>
                              <option >Metformin</option>
                              <option >NovoRapid</option>
                              <option >Prandin</option>
                              <option >Starlix</option>
                              <option >Trulicity</option>
                              <option >Victoza</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                          <hr />
                          <form action="#">
                            <label for="medicines">Drug 5</label>
                            <select name="medicines" id="med">
                              <option >Select drug 5</option>
                              <option >Actos</option>
                              <option >Actrapid</option>
                              <option >Augmentin</option>
                              <option >Amaryl</option>
                              <option >Byetta</option>
                              <option >Bydreoun</option>
                              <option >Competact</option>
                              <option >Diamicron</option>
                              <option >Eucreas</option>
                              <option >Forxiga</option>
                              <option >Galvus</option>
                              <option >Gliclazide	</option>
                              <option >Glucobay</option>
                              <option >Humalog</option>
                              <option >Humulin I</option>
                              <option >Hypurin Bovine Isophane</option>
                              <option >Hypurin Bovine Lente</option>
                              <option >Hypurin Bovine Protamine Zinc</option>
                              <option >Insulin Glulisine</option>
                              <option >Insuman Basal</option>
                              <option >Insuman Comb</option>
                              <option >Janumet</option>
                              <option >Januvia</option>
                              <option >Lantus</option>
                              <option >Lucentis</option>
                              <option >Lyxumia</option>
                              <option >Metformin</option>
                              <option >NovoRapid</option>
                              <option >Prandin</option>
                              <option >Starlix</option>
                              <option >Trulicity</option>
                              <option >Victoza</option>
                            </select>
                            <!-- <input type="submit" value="Submit" /> -->
                      </form>
                          <hr />
                        <form action="#">
                          <label for="medicines">Drug 6</label>
                          <select name="medicines" id="med">
                            <option >Select drug 6</option>
                            <option >Actos</option>
                            <option >Actrapid</option>
                            <option >Augmentin</option>
                            <option >Amaryl</option>
                            <option >Byetta</option>
                            <option >Bydreoun</option>
                            <option >Competact</option>
                            <option >Diamicron</option>
                            <option >Eucreas</option>
                            <option >Forxiga</option>
                            <option >Galvus</option>
                            <option >Gliclazide	</option>
                            <option >Glucobay</option>
                            <option >Humalog</option>
                            <option >Humulin I</option>
                            <option >Hypurin Bovine Isophane</option>
                            <option >Hypurin Bovine Lente</option>
                            <option >Hypurin Bovine Protamine Zinc</option>
                            <option >Insulin Glulisine</option>
                            <option >Insuman Basal</option>
                            <option >Insuman Comb</option>
                            <option >Janumet</option>
                            <option >Januvia</option>
                            <option >Lantus</option>
                            <option >Lucentis</option>
                            <option >Lyxumia</option>
                            <option >Metformin</option>
                            <option >NovoRapid</option>
                            <option >Prandin</option>
                            <option >Starlix</option>
                            <option >Trulicity</option>
                            <option >Victoza</option>
                          </select>
                          <!-- <input type="submit" value="Submit" /> -->
                    </form>
                        <hr />
                      <form action="#">
                        <label for="medicines">Drug 7</label>
                        <select name="medicines" id="med">
                          <option >Select drug 7</option>
                          <option >Actos</option>
                          <option >Actrapid</option>
                          <option >Augmentin</option>
                          <option >Amaryl</option>
                          <option >Byetta</option>
                          <option >Bydreoun</option>
                          <option >Competact</option>
                          <option >Diamicron</option>
                          <option >Eucreas</option>
                          <option >Forxiga</option>
                          <option >Galvus</option>
                          <option >Gliclazide	</option>
                          <option >Glucobay</option>
                          <option >Humalog</option>
                          <option >Humulin I</option>
                          <option >Hypurin Bovine Isophane</option>
                          <option >Hypurin Bovine Lente</option>
                          <option >Hypurin Bovine Protamine Zinc</option>
                          <option >Insulin Glulisine</option>
                          <option >Insuman Basal</option>
                          <option >Insuman Comb</option>
                          <option >Janumet</option>
                          <option >Januvia</option>
                          <option >Lantus</option>
                          <option >Lucentis</option>
                          <option >Lyxumia</option>
                          <option >Metformin</option>
                          <option >NovoRapid</option>
                          <option >Prandin</option>
                          <option >Starlix</option>
                          <option >Trulicity</option>
                          <option >Victoza</option>
                        </select>
                        <!-- <input type="submit" value="Submit" /> -->
                  </form>

                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div id="snacking">Saving...</div>
                <div id="snacked">Saved!</div>
                <button class="buttonn" onclick="printFunction()">Print</button>
                <!-- <button onclick="generatePDF()">Download as PDF</button> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="sideNav">
      <nav>
        <ul>
          <li><a href="#regform">Login Form</a></li>
          <li><a href="#footer">Contact Us</a></li>
        </ul>
      </nav>
    </div>

    <!--the button layout -->
    <div id="menuButton">
      <img src= "{%static 'Images/menu.png'%}" id="menu" />
    </div>
    {% include 'Pages/footer.html'%}

  </body>
  <!--the following is our scripts -->
  <script>
    var menuButton = document.getElementById('menuButton')
    var sideNav = document.getElementById('sideNav')
    var menu = document.getElementById('menu')

    sideNav.style.right == '-250px'

    menuButton.onclick = function () {
      if (sideNav.style.right == '-250px') {
        sideNav.style.right = '0'
        menu.src = "{% static 'Images/menu_inverse.png' %}"
      } else {
        sideNav.style.right = '-250px'
        menu.src = "{% static 'Images/menu.png' %}"
      }
    }
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 1000,
      speedAsDuration: true,
    })
  </script>
  <script>
    var subject2 = {
      'Front-end': {},
      'Back-end': {},
    }
    window.onload = function () {
      var subjectSel = document.getElementById('subject2')

      for (var x in subject2) {
        subjectSel.options[subjectSel.options.length] = new Option(x, x)
      }
      subjectSel.onchange = function () {
        //empty Chapters- and Topics- dropdowns
        chapterSel.length = 1
        topicSel.length = 1
        //display correct values
        for (var y in subjectObject[this.value]) {
          topicSel.options[topicSel.options.length] = new Option(y, y)
        }
      }
      topicSel.onchange = function () {
        //empty Chapters dropdown
        chapterSel.length = 1
        //display correct values
        var z = subject2[subjectSel.value][this.value]
        for (var i = 0; i < z.length; i++) {
          chapterSel.options[chapterSel.options.length] = new Option(z[i], z[i])
        }
      }
    }
  </script>

  <script>
    $(document).ready(function () {
      Date.prototype.calcDate = function (days) {
        let date = new Date(this.valueOf())
        date.setDate(date.getDate() + days)
        return `(Untill ${date.getUTCDate()}-${
          date.getUTCMonth() + 1
        }-${date.getUTCFullYear()})`
      }
      let timeout
      function snackSaving() {
        let snack = document.getElementById('snacking')
        snack.className = 'show'
        timeout = setTimeout(() => {
          alert('ERR: Conection timeout.')
        }, 8000)
      }
      function snackSaved() {
        clearTimeout(timeout)
        let snack = document.getElementById('snacking')
        snack.className = snack.className.replace('show', '')
        let snacked = document.getElementById('snacked')
        snacked.className = 'show'
        setTimeout(function () {
          snacked.className = snacked.className.replace('show', '')
        }, 1500)
      }
      $('[data-toggle=tooltip]').tooltip('show')
      setTimeout(function () {
        $('[data-toggle=tooltip]').tooltip('hide')
      }, 5000) //hide tooltips after 5sec
      $(document).keyup(function () {
        $('[data-toggle=tooltip]').tooltip('hide')
      }) //hide tooltip while typing
      $(document).on('focusin keypress', '.med_name', function (e) {
        let x = $(this).siblings('div.med_name_action')
        if (e.type == 'focusin') {
          x.css('display', 'block')
        }
        if (e.type == 'keypress') {
          if (e.keyCode == 13) x.children('button.save').click()
        }
      })

      $(document).on('click', '.cancel-btn', function () {
        $(this).parent().css('display', 'none') //hides save/cancel btn
      })
      $(document).on('click', '.med_name_action button.save', function () {
        $(this).parent().css('display', 'none')
        $('.sc_time').removeClass('folded')
      })
      $('.med_name').keypress(function (e) {
        if (e.which == 13) {
          $('#symp_save').click()
        }
      })

      $(document).on('mousedown', '.sc', function (e) {
        let x = $(this).siblings('div.med_when_action')
        x.css('display', 'block')
      })
      $(document).on('click', '.med_when_action button.save', function () {
        $(this).parent().css('display', 'none')
        $('.select').removeClass('folded')
      })
      $('select.sc').change(function () {
        let x = $(this).siblings('div.med_when_action')
        x.css('display', 'none')
      })

      $(document).on('mousedown', '.meal', function () {
        let x = $(this).siblings('div.med_meal_action')
        x.css('display', 'block')
      })
      $(document).on('click', '.med_meal_action button.save', function () {
        $(this).parent().css('display', 'none')
        $('.period').removeClass('folded')
      })

      $(document).on('focusin keypress', '.med_period', function (e) {
        let x = $(this).siblings('div.med_period_action')
        if (e.type == 'focusin') {
          x.css('display', 'block')
        }
        if (e.type == 'keypress') {
          if (e.keyCode == 13) x.children('button.save').click()
        }
      })
      $(document).on('click', '.med_period_action button.save', function () {
        $(this).parent().css('display', 'none')
      })
      $(document).on('keyup', '.med_period', function () {
        let period = $(this).val()
        let num = +period.match(/\d+/g)[0]
        let type = period.match(/\b(\w)/g)[1]
        let days = null
        if (type == 'd') days = num
        else if (type == 'w') days = num * 7
        else if (type == 'm') days = num * 30
        else if (type == 'y') days = num * 365
        let span = $(this).siblings('span.date')
        if (days) {
          let date = new Date().calcDate(days)
          span.html(date)
        } else {
          span.html('(Invalid time period)')
        }
      })

      $('.sc').keyup(function (e) {
        if (isNaN(e.key)) return
        let el = $(this)
        el = el.val().split('-').join('')
        let finalVal = el.match(/.{1,1}/g).join('-')
        $(this).val(finalVal)
      })
      function initLi(e) {
        let txt = e.target.innerHTML
        if (!txt.includes('<li>')) {
          let el = '<li></li>'
          $(this).append(el)
        }
      }
      $('.symptoms ul').focusin(initLi)
      $('.symptoms ul').keyup(function (e) {
        let fl = $(this).children().first()
        let el = `<li>${e.target.textContent}</li>`
        if (fl.text().length < 1) {
          $(this).html('')
          $(this).append(el)
        }
      })
      $('#symp_save').click(function () {
        $('.symp_action').css('display', 'none')
      })

      $('.tests ul').focusin(initLi)
      $('.tests ul').keyup(function () {
        let fl = $(this).children().first()
        let el = '<li></li>'
        if (fl.text().length < 1) {
          $(this).html('')
          $(this).append(el)
        }
      })
      $('#test_save').click(function () {
        $('.test_action').css('display', 'none')
      })

      $('.symptoms ul').focusin(function () {
        $('.symp_action').css('display', 'block')
      })

      $('.tests ul').focusin(function () {
        $('.test_action').css('display', 'block')
      })

      $('.advice p').focusin(function () {
        $('.adv_action').css('display', 'block')
      })

      $('#adv_save').click(function () {
        $('.adv_action').css('display', 'none')
      })

      $(document).on('click', '.delete', function () {
        let parent = $(this).closest('.med')
        parent.remove()
      })

      let med_id = 1
      $('#add_med').click(function () {
        med_id++
        let sourceTemplate = $('#new_medicine').html()
        Mustache.parse(sourceTemplate)
        let sourceHTML = Mustache.render(sourceTemplate, { med_id })
        let medicine = $('.med_list')
        medicine.append(sourceHTML)
      })
    })
  </script>

  <script>
    function printFunction() {
      window.print()
    }
  </script>

  <script>
    function generatePDF() {
      // Choose the element that our invoice is rendered in.
      const element = document.getElementById('prescription_form')
      // Choose the element and save the PDF for our user.
      html2pdf().from(element).save()
    }
  </script>
</html>
{%endblock check%}